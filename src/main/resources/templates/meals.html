<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Meals</title>
</head>
<body class="bg-blue-200">

<!--Insert NavBar Fragment-->

<div th:replace="fragments/navbar :: navbar"></div>


<h1 class="grid place-items-center mt-5 mb-5">Meals</h1>

<!-- Show Meals-->
<div class="grid place-items-center">
    <div th:with="mealCals=0" class="grid grid-cols-4">
        <div th:each="meal : ${meals}" class="border-2 border-black p-5 rounded-md mt-3 mr-2 text-center w-64 bg-cyan-300">
            <!--  <div th:if="${param.list}">-->

            <p><span th:text="${meal.mealType}" class="text-red-700 font-semibold text-lg">none</span></p>
            <p>Date: <span th:text="${meal.date}" class="text-black"></span></p>
            <p>Time: <span th:text="${meal.time}" class="text-black"></span></p>
            <br/>
<!--            <p th:with="mealCals=0">Total Calories: <span th:text="${mealCals}"></span></p>-->

<!--            <br/>-->
            <table>
                <tr>
                    <th>Food</th>
                    <th>Servings</th>
                    <th>Calories</th>
                </tr>
                <tr th:each="serving : ${meal.servings}">
                    <td th:text="${serving.food.getName()}"></td>
                    <td th:text="${serving.getNumber()}"></td>
                    <td th:with="totalCals=${serving.number * serving.food.getCalories()}"><span th:text="${totalCals}"></span></td>
<!--                    <td><span th:text="${#aggregates.sum(serving.number * serving.food.getCalories())}"></span></td>-->
                </tr>
<!--                <tr>-->
<!--                    <td>Total Calories: <span th:text="${#aggregates.sum(totalCals)}"></span></td>-->
<!--                </tr>-->
            </table>
            <div class="mt-2">
                <p class="font-semibold">Meal Calories: <span th:text="${meal.mealCals}" class="font-bold text-lg"></span></p>
            </div>

        </div>
    </div>

</div>


<!--Create Footer-->
<script src="js/script.js"></script>
</body>
</html>